{% extends "index.html" %}

{% block content %}
    <script>
    $(function() {
        var nbaCompsReset = false;
        var submit_form = function(e) {
            var data_items = [];
            $("input:checkbox[class=pad]:checked").each(function () {
                data_items.push($(this).val());
            });

            $.getJSON($SCRIPT_ROOT + '/_getComps', {
                data: JSON.stringify({ data_selected: data_items }),
                playerID: {{ player.id }}
            }, function(data){
                nbaCompsReset = true;
                var json = data.result;
                for (var i = 0; i < json.length; i++) {
                    var player = json[i];
                    var q = i + 1;
                    $("#img" + q.toString()).attr("src", "https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/" + player['team_id'] + "/2017/260x190/" + player['id'] + ".png");
                    $("#name" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['name']);
                    $("#logo" + q.toString()).attr("src", "http://stats.nba.com/media/img/teams/logos/" + player['team'] + "_logo.svg");
                    $("#hwpos" + q.toString()).text(player['height'] + " | " + player['weight'] +" lbs | " + player['position']);
                    $("#gp" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_g']);

                    $("#min" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_min']);
                    $("#fgper" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_fgper']);
                    $("#threeper" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_threeper']);
                    $("#ftper" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_ftper']);
                    $("#pts" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_pts']);
                    $("#reb" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_reb']);
                    $("#ast" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_ast']);
                    $("#stl" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_stl']);
                    $("#blk" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_blk']);

                }
            });
        return false;
        };

        $('#getCompsButton').bind('click', submit_form);
    });

    </script>

    <div class="container" id="page_data">
        <div class="row center">
            <div class="col-sm-12 col-md-4" style="display:inline-block">
                <div class="row center padding-top-bottom">
                <div class="row">
                    <a href="http://stats.gleague.nba.com/player/#!/{{ player.gleague_id }}" target="_blank">
                        <h3 style="display:inline;color:black;" class="center">{{ player.name }}</h3>
                    </a>
                    <h4 style="display:inline;"><img class="logo-gleague" src="http://stats.gleague.nba.com/media/img/teams/logos/{{ player.team }}.svg">Age: {{ player.age }}</h4>
                </div>
                <div class="row">
                    {% if player.height != "" %}
                        <h4 style="display:inline;"> {{ player.height }} | </h4>
                    {% endif %}
                    {% if player.weight != "" %}
                        <h4 style="display:inline;"> {{ player.weight }} lbs | </h4>
                    {% endif %}
                    {% if player.bg != "" %}
                        <h4 style="display:inline;"> {{ player.bg }}</h4>
                    {% endif %}
                    {% if player.position != "" %}
                        <h4 style="display:inline;">| {{ player.position }} </h4>
                    {% endif %}
                </div>
            </div>
                <div class="row" style="text-align:center;">
                <div class="col-xs-12 col-sm-6 col-md-8">
                    <div class="row">
                        <img class="main-headshot" src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/dleague/{{ player.pic_id }}.png" onerror="usePlaceholder(this)">
                    </div>
                    <div class="row center padding-20">
                        <details>
                            <summary id="cluster-no-blue">
                                <span>G League Clusters:<br>{{ player.gnb_cluster }} (GNB)</span><br>
                                <span>{{ player.knn_cluster }} (knn)</span>
                            </summary>
                            <p class="padding-top">Based on the RCC framework which uses a Gaussian Naive Bayes model for classification. Refer to the diagram on the right to discover the role-transformations {{ player.gnb_cluster }}s typically make once they get to the NBA. </p>
                        </details>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 padding-20">
                    <div class="row center" style="font-size: 12px;">
                        <strong>2017-2018 G League Stats per 36 Min:</strong>
                        <p style="padding-top:10px;"><sup class="name">GP</sup>{{ player.gp }}</p>
                        <p><sup class="name">PTS</sup>{{ player.pts }}</p>
                        <p><sup class="name">FGA</sup>{{ player.fga }}</p>
                        <p><sup class="name">3PM</sup>{{ player.threepm }}</p>
                        <p><sup class="name">REB</sup>{{ player.reb }}</p>
                        <p><sup class="name">AST</sup>{{ player.ast }}</p>
                    </div>
                </div>
            </div>

        </div>

        <div class="col-sm-12 col-md-8" style="display:inline-block">
            <div class="row" style="text-align:center !important;padding-top: 40px;">
                <img style="width:90%;" src="{{ url_for('static', filename='cluster_alluvial.png') }}">
            </div>
            <div class="row">
                <span style="font-size: 11px;"> Use this flow chart to visualize the role-transformations that exist between the G League and the NBA </span>
            </div>
        </div>
    </div>

        <div class="row padding-top-bottom" style="text-align: center;" >
        {% if player.gamelog != None %}
            <div class="col-sm-12 col-md-6">
                <h3>Last 10 Games Log</h3>
                <div class="table-responsive">
                    <table id="gamelog_table" class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr>
                            <th>Date</th>
                            <th>Matchup</th>
                            <th>Result</th>
                            <th>Min</th>
                            <th>PTS</th>
                            <th>FGA</th>
                            <th>3PM</th>
                            <th>REB</th>
                            <th>AST</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for game in player.gamelog %}
                            <tr>
                                <td>{{ game[3] }}</td>
                                <td>{{ game[4] }}</td>
                                <td>{{ game[5] }}</td>
                                <td>{{ game[6] }}</td>
                                <td>{{ game[24] }}</td>
                                <td>{{ game[8] }}</td>
                                <td>{{ game[10] }}</td>
                                <td>{{ game[18] }}</td>
                                <td>{{ game[19] }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}
            <div class="col-sm-12 col-md-6" >
                <h3>2017-18 Shot Chart</h3>
                <iframe id="shotchart" width="375px" height="436px" src="http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=0&DateFrom=&DateTo=&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1"></iframe>
            </div>
        </div>

    <div class="row center padding-20">
{#    <div class="row padding-top-bottom">#}
{#        <h3>G League Player Comparisons:</h3>#}
{#    </div>#}
{#    <div class="row padding-20">#}
{#        {% for n in player.neighbors %}#}
{#            <div class="col-sm-12 col-md-4">#}
{#                <div class="row center">#}
{#                    <img class="neighbor-headshot center comparisons"#}
{#                         src="https://d2cwpp38twqe55.cloudfront.net/req/201712064/images/players/{{ n.pic_id }}.jpg" onerror="usePlaceholder(this)">#}
{#                    <h4 class="center">{{ n.name }}</h4>#}
{#                    <h5 class="center">{{ n.height }} | {{ n.weight }} lbs</h5>#}
{#                </div>#}
{#                <div class="row">#}
{#                    <strong>G League Cluster: {{ n.gleague_cluster }}</strong><br>#}
{#                    <strong>NBA Cluster: {{ n.nba_cluster }}</strong>#}
{#                </div>#}
{#                <div class="row padding-20">#}
{##}
{#                    <table class="table table-striped table-bordered table-hover table-responsive stats">#}
{#                        <thead>#}
{#                        <tr>#}
{#                            <th></th>#}
{#                            <th>G League</th>#}
{#                            <th>NBA</th>#}
{#                        </tr>#}
{#                        </thead>#}
{#                        <tbody>#}
{#                        <tr>#}
{#                            <td>#}
{#                                GP#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_g }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_g }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                PTS#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_pts }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_pts}}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                FGA#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_fga }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_fga }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                3PM#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_threepm }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_threepm }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                REB#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_reb }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_reb }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                AST#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_ast }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_ast }}#}
{#                            </td>#}
{#                        </tr>#}
{##}
{##}
{#                        </tbody>#}
{#                    </table>#}
{#                </div>#}
{##}
{#            </div>#}
{#        {% endfor %}#}
{#    </div>#}
    {% if player.nba_comps != None %}
    <div class="row padding-top-bottom">
        <h3>NBA player comparisons using the <a href="http://gleague.nba.com/news/introducing-nba-projections/">G League's NBA Projections tool:</a></h3>
        <h4>These NBA comparisons are based on pace-adjusted per 36 minute boxscore stats and each player is required to have played >= 300 min.</h4>
        <h4>Use the checkboxes below to narrow your NBA comparison search!</h4>
    </div>
        <button class='button-style' onclick="check_uncheck_all(this)" id='checkall' data-checked='false'>Check/Uncheck All</button>
        <input class="pad" type="checkbox" id="pts" value="pts" checked/><label for="pts" class="pad">PTS</label>
        <input class="pad" type="checkbox" id="reb" value="reb" checked/><label for="reb" class="pad">REB</label>
        <input class="pad" type="checkbox" id="ast" value="ast" checked/><label for="ast" class="pad">AST</label>
        <input class="pad" type="checkbox" id="stl" value="stl" checked/><label for="stl" class="pad">STL</label>
        <input class="pad" type="checkbox" id="blk" value="blk" checked/><label for="blk" class="pad">BLK</label>
        <input class="pad" type="checkbox" id="fgper" value="fgper" checked/><label for="fgper" class="pad">FG%</label>
        <input class="pad" type="checkbox" id="threeper" value="threeper" checked/><label for="threeper" class="pad">3P%</label>
        <input class="pad" type="checkbox" id="ftper" value="ftper" checked/><label for="ftper" class="pad">FT%</label>
        <input class="pad" type="checkbox" id="height" value="height" checked/><label for="height" class="pad">Height</label>
        <input class="pad" type="checkbox" id="weight" value="weight" checked/><label for="weight" class="pad">Weight</label>
        <input class="button-style" id="getCompsButton" type="submit" value="Find NBA Comparisons">
        <div class="row padding-20">
            <div class="col-sm-12 col-md-4">
                <div class="row center">
                    <img id="img1" class="nba-comp-headshot center comparisons"
                         src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/{{ player.nba_comps[0].team_id }}/2017/260x190/{{ player.nba_comps[0].id }}.png" onerror="usePlaceholder(this)">
                    <h4 style="margin-bottom:0;" id="name1" class="center">{{ player.nba_comps[0].name }}<img id="logo1" class="logo" src="http://stats.nba.com/media/img/teams/logos/{{ player.nba_comps[0].team }}_logo.svg"> </h4>
                    <div class="row center">
                        <span style="font-size:12px;" id="hwpos1" class="center">{{ player.nba_comps[0].height }} | {{ player.nba_comps[0].weight }} lbs | {{ player.nba_comps[0].position }}</span>
                    </div>
                    <div class="row center padding-top">
                        <span style="font-size: 11px;">2017-2018 NBA per 36 min pace-adjusted stats:</span>
                    </div>

                    <div class="row center" style="font-size: 12px; width:60%; margin:0 auto;">
                        <div class="col-xs-6">
                            <p id="gp1" style="padding-top:10px;"><sup class="name">GP</sup>{{ player.nba_comps[0].nba_g }}</p>
                            <p id="min1"><sup class="name">MIN</sup>{{ player.nba_comps[0].nba_min }}</p>
                            <p id="fgper1"><sup class="name">FG%</sup>{{ player.nba_comps[0].nba_fgper }}</p>
                            <p id="threeper1"><sup class="name">3P%</sup>{{ player.nba_comps[0].nba_threeper }}</p>
                            <p id="ftper1"><sup class="name">FT%</sup>{{ player.nba_comps[0].nba_ftper }}</p>

                        </div>
                        <div class="col-xs-6">
                            <p id="pts1" style="padding-top:10px;"><sup class="name">PTS</sup>{{ player.nba_comps[0].nba_pts }}</p>
                            <p id="reb1"><sup class="name">REB</sup>{{ player.nba_comps[0].nba_reb }}</p>
                            <p id="ast1"><sup class="name">AST</sup>{{ player.nba_comps[0].nba_ast }}</p>
                            <p id="stl1"><sup class="name">STL</sup>{{ player.nba_comps[0].nba_stl }}</p>
                            <p id="blk1"><sup class="name">BLK</sup>{{ player.nba_comps[0].nba_blk }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-4">
                <div class="row center">
                    <img id="img2" class="nba-comp-headshot center comparisons"
                         src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/{{ player.nba_comps[1].team_id }}/2017/260x190/{{ player.nba_comps[1].id }}.png" onerror="usePlaceholder(this)">
                    <h4 style="margin-bottom:0;" id="name2" class="center">{{ player.nba_comps[1].name }}<img id="logo2" class="logo" src="http://stats.nba.com/media/img/teams/logos/{{ player.nba_comps[1].team }}_logo.svg"> </h4>
                    <div class="row center">
                         <span style="font-size:12px;" id="hwpos2" class="center">{{ player.nba_comps[1].height }} | {{ player.nba_comps[1].weight }} lbs | {{ player.nba_comps[1].position }}</span>
                    </div>
                    <div class="row center padding-top">
                        <span style="font-size: 11px;">2017-2018 NBA per 36 min pace-adjusted stats:</span>
                    </div>
                        <div class="row center" style="font-size: 12px; width:60%; margin:0 auto;">
                        <div class="col-xs-6">
                            <p id="gp2" style="padding-top:10px;"><sup class="name">GP</sup>{{ player.nba_comps[1].nba_g }}</p>
                            <p id="min2"><sup class="name">MIN</sup>{{ player.nba_comps[1].nba_min }}</p>
                            <p id="fgper2"><sup class="name">FG%</sup>{{ player.nba_comps[1].nba_fgper }}</p>
                            <p id="threeper2"><sup class="name">3P%</sup>{{ player.nba_comps[1].nba_threeper }}</p>
                            <p id="ftper2"><sup class="name">FT%</sup>{{ player.nba_comps[1].nba_ftper }}</p>

                        </div>
                        <div class="col-xs-6">
                            <p id="pts2" style="padding-top:10px;"><sup class="name">PTS</sup>{{ player.nba_comps[1].nba_pts }}</p>
                            <p id="reb2"><sup class="name">REB</sup>{{ player.nba_comps[1].nba_reb }}</p>
                            <p id="ast2"><sup class="name">AST</sup>{{ player.nba_comps[1].nba_ast }}</p>
                            <p id="stl2"><sup class="name">STL</sup>{{ player.nba_comps[1].nba_stl }}</p>
                            <p id="blk2"><sup class="name">BLK</sup>{{ player.nba_comps[1].nba_blk }}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-4">
                <div class="row center">
                    <img id="img3" class="nba-comp-headshot center comparisons"
                         src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/{{ player.nba_comps[2].team_id }}/2017/260x190/{{ player.nba_comps[2].id }}.png" onerror="usePlaceholder(this)">
                    <h4 style="margin-bottom:0;" id="name3" class="center">{{ player.nba_comps[2].name }}<img id="logo3" class="logo" src="http://stats.nba.com/media/img/teams/logos/{{ player.nba_comps[2].team }}_logo.svg"> </h4>
                    <div class="row center">
                         <span style="font-size:12px;" id="hwpos3" class="center">{{ player.nba_comps[2].height }} | {{ player.nba_comps[2].weight }} lbs | {{ player.nba_comps[2].position }}</span>
                    </div>
                    <div class="row center padding-top">
                        <span style="font-size: 11px;">2017-2018 NBA per 36 min pace-adjusted stats:</span>
                    </div>
                    <div class="row center" style="font-size: 12px; width:60%; margin:0 auto;">
                        <div class="col-xs-6">
                            <p id="gp3" style="padding-top:10px;"><sup class="name">GP</sup>{{ player.nba_comps[2].nba_g }}</p>
                            <p id="min3"><sup class="name">MIN</sup>{{ player.nba_comps[2].nba_min }}</p>
                            <p id="fgper3"><sup class="name">FG%</sup>{{ player.nba_comps[2].nba_fgper }}</p>
                            <p id="threeper3"><sup class="name">3P%</sup>{{ player.nba_comps[2].nba_threeper }}</p>
                            <p id="ftper3"><sup class="name">FT%</sup>{{ player.nba_comps[2].nba_ftper }}</p>
                        </div>
                        <div class="col-xs-6">
                            <p id="pts3" style="padding-top:10px;"><sup class="name">PTS</sup>{{ player.nba_comps[2].nba_pts }}</p>
                            <p id="reb3"><sup class="name">REB</sup>{{ player.nba_comps[2].nba_reb }}</p>
                            <p id="ast3"><sup class="name">AST</sup>{{ player.nba_comps[2].nba_ast }}</p>
                            <p id="stl3"><sup class="name">STL</sup>{{ player.nba_comps[2].nba_stl }}</p>
                            <p id="blk3"><sup class="name">BLK</sup>{{ player.nba_comps[2].nba_blk }}</p>
                        </div>
                    </div>
                </div>
            </div>
{#                <div class="row padding-20">#}
{##}
{#                    <table class="table table-striped table-bordered table-hover table-responsive stats">#}
{#                        <thead>#}
{#                        <tr>#}
{#                            <th></th>#}
{#                            <th>G League</th>#}
{#                            <th>NBA</th>#}
{#                        </tr>#}
{#                        </thead>#}
{#                        <tbody>#}
{#                        <tr>#}
{#                            <td>#}
{#                                GP#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_g }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_g }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                PTS#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_pts }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_pts}}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                FGA#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_fga }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_fga }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                3PM#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_threepm }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_threepm }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                REB#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_reb }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_reb }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                AST#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_ast }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_ast }}#}
{#                            </td>#}
{#                        </tr>#}
{##}
{##}
{#                        </tbody>#}
{#                    </table>#}
{#                </div>#}

    </div>
    {% endif %}
</div>
</div>
{% endblock %}