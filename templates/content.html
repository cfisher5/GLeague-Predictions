{% extends "index.html" %}

{% block content %}
    <script>
    $(function() {
        var nbaCompsReset = false;
        var submit_form = function(e) {
            var comp_content_height = document.getElementById("comp-content").clientHeight;
            var padding_bottom = comp_content_height - 268 + 83;
            document.getElementById("loader").style.paddingBottom = padding_bottom + "px";
            document.getElementById("comp-content").style.display = "none";
            document.getElementById("loader").style.display = "block";
            setTimeout(function(){
                document.getElementById("loader").style.display = "none";
                document.getElementById("comp-content").style.display = "block";
            }, 1500);

            var data_items = [];
            $("input:checkbox[class=pad]:checked").each(function () {
                data_items.push($(this).val());
            });

            $.getJSON($SCRIPT_ROOT + '/_getComps', {
                data: JSON.stringify({ data_selected: data_items }),
                playerID: {{ player.id }}
            }, function(data){
                nbaCompsReset = true;
                var json = data.result;
                for (var i = 0; i < json.length; i++) {
                    var player = json[i];
                    var q = i + 1;
                    $("#img" + q.toString()).attr("src", "https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/latest/260x190/" + player['id'] + ".png");
                    $("#name" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['name']);
                    $("#logo" + q.toString()).attr("src", "https://stats.nba.com/media/img/teams/logos/" + player['team'] + "_logo.svg");
                    $("#hwpos" + q.toString()).text(player['height'] + " • " + player['weight'] +" lbs • " + player['position']);
                    $("#g_mpg" + q.toString()).text(player['nba_g'] + " Games Played • " + player['mpg'] + " min/G");

                    var chart_id = "comp" + q.toString() + "_stats";
                    var old_chart = "canvas#" + chart_id;
                    $(old_chart).remove();

                    var div_container = "div." + chart_id;
                    $(div_container).children().eq(1).append('<canvas id=\"' + chart_id + '\"></canvas>');
                    create_bar_chart(chart_id, player);
{#                    $("#min" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_min']);#}
{#                    $("#fgper" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_fgper']);#}
{#                    $("#threeper" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_threeper']);#}
{#                    $("#ftper" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_ftper']);#}
{#                    $("#pts" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_pts']);#}
{#                    $("#reb" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_reb']);#}
{#                    $("#ast" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_ast']);#}
{#                    $("#stl" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_stl']);#}
{#                    $("#blk" + q.toString()).contents().filter(function(){ return this.nodeType == 3; }).first().replaceWith(player['nba_blk']);#}

                }
            });
        return false;
        };

        $('#getCompsButton').bind('click', submit_form);
    });

    </script>

    <div class="container" id="page_data">
        <div id="player_info_row" class="row center border-bottom">
            <div id="player_bio" class="border-bottom-special margin-when-small col-xs-12 col-sm-12 col-md-4 border-right">
                <div class="row center">
                    <div class="row" style="padding-bottom:10px;">
                        <a href="http://stats.gleague.nba.com/player/#!/{{ player.gleague_id }}" target="_blank">
                            <h3 style="display:inline;color:black;" class="center">{{ player.name }}</h3>
                        </a>
                        {% if player.two_way == True %}
                            <div style="display:inline;">
                                <img class="logo-gleague" src="http://stats.gleague.nba.com/media/img/teams/logos/{{ player.team }}.svg">
                                <div style="display:inline-block;padding:0 20px;">
                                    <div class="row" style="font-size:8px;">
                                        <span style="font-size:8px;font-weight:bold;">TWO-WAY</span>
                                    </div>
                                    <div class="row">
                                        <img class="logo-gleague" style="padding-top:0;" src="https://stats.nba.com/media/img/teams/logos/{{ player.nba_team }}_logo.svg">
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <div style="display:inline;"><img class="logo-gleague" src="http://stats.gleague.nba.com/media/img/teams/logos/{{ player.team }}.svg"></div>
                        {% endif %}
                    </div>
                    <div class="row" style="padding-bottom:20px;padding-left:25px;padding-right:25px;">
                        {% if player.height != "" %}
                            <h5 style="display:inline;font-size:13px;"> {{ player.height }} • </h5>
                        {% endif %}
                        {% if player.weight != "" %}
                            <h5 style="display:inline;font-size:13px;"> {{ player.weight }} lbs • </h5>
                        {% endif %}
                        {% if player.position != "" %}
                            <h5 style="display:inline;font-size:13px;">{{ player.position }} • </h5>
                        {% endif %}
                        {% if player.bg != "" and player.bg != None %}
                            <h5 style="font-size:13px;display:inline;">{{ player.bg }} • </h5>
                        {% endif %}
                        <h5 style="display:inline;font-size:13px;">Age: {{ player.age }} </h5>
                    </div>
                </div>
                <div class="row" style="text-align:center;">
                    <img class="main-headshot" src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/dleague/{{ player.pic_id }}.png" onerror="usePlaceholder(this)">
                </div>

            </div>
            <div id='stats_div' class="margin-when-small col-xs-12 col-sm-12 col-md-8">
                <div class="row">
                    <strong style="padding:0 5px;">2017-2018 G League Stats Profile (Box Score per 36 min & Advanced)</strong>
                    <p style="padding-top:5px;font-size:11px;margin:0;">{{player.gp}} Games Played • {{ player.mpg }} min/G</p>
                </div>
                <div class="row border-pad-bottom" style="padding-top:15px;">
                    <div class="col-xs-12 col-sm-6 border-right-special pad-when-small">
                        <div id='stats' style="position: relative;max-width:400px;margin:0 auto;">
                            <canvas id="player_stats"></canvas>
                            <p style="text-align: center;padding-left:45px;padding-bottom:5px;margin:0;font-size:9px;font-style:italic;">50th percentile</p>
                            <h5 style="font-size:10px;margin:0;">Percentiles relative to all qualified G League Players (over 200 min) <strong>of the same position.</strong> Hover over the bar to see the percentile.</h5>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6 pad-when-small">
                        <div style="position: relative;max-width:400px;margin:0 auto;">
                            <canvas id="player_adv_stats"></canvas>
                            <p style="text-align: center;padding-left:75px;padding-bottom:5px;margin:0;font-size:9px;font-style:italic;">50th percentile</p>
                            <h5 style="font-size:10px;margin:0;">Percentiles relative to all qualified G League Players (over 7 GP) <strong>of the same position.</strong> Hover over the bar to see the percentile.</h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row border-bottom explanation" style="padding-top: 40px;padding-bottom:25px;">
        <div class="col-xs-12 col-sm-5" style="padding-bottom:20px;padding-top:40px;padding-right:30px;text-align:justify">
            <strong>Use the role-transformation diagram to trace the different paths players take when they go from the G League to the NBA.</strong><br><br>
            <strong>Since the two leagues are so different from a talent standpoint, G League players must adapt and settle into a different role.</strong><br><br>
            <strong> {{ player.name }} is a G League <strong style="color:{{ player.cluster_color }};"> {{ player.gnb_cluster }} </strong> so trace the paths {{ player.gnb_cluster }}s usually take when going from the G League to the NBA.</strong><br><br>
            <button class="collapsible">Learn More</button>
            <div class="collapsible-content">
                <span>The path thickness represents the number of G League players with that G League role from 2010-2017 who have gone on to the NBA and played that NBA role. Hover over the path to see the number of players in the dataset with that role.</span>
            </div>
        </div>
        <div class="col-xs-12 col-sm-7" style="display:inline-block">
            <div id="alluvial_roles" class="row">
                <div class="col-xs-6"></div>
                <div class="col-xs-3" style="padding:0;">
                    <span class="alluvial_label" style="font-size:11px;">G League Role</span>
                </div>
                <div class="col-xs-3" style="text-align:right;padding:0;">
                    <span class="alluvial_label" style="font-size:11px;">NBA Role</span>
                </div>
            </div>
            <div id="alluvial" class="row" style="text-align:center;">
                <svg viewbox="0 0 650 420" width="100%" height="100%" preserveAspectRatio="xMinYMin meet"  xmlns="https://www.w3.org/2000/svg" version="1.1"><g transform="translate(0,10)">
                    <g>
                        <path class="isb link" d="M327.5,34.50704225352115C486.25,34.50704225352115 486.25,39.50704225352112 645,39.50704225352112" style="stroke-width: 69.0141; fill: none; stroke: rgb(105, 191, 139); stroke-opacity: 0.4;"><title>28</title></path>
                        <path class="link" d="M5,362.88732394366195C163.75,362.88732394366195 163.75,372.887323943662 322.5,372.887323943662" style="stroke-width: 54.2254; fill: none; stroke: rgb(174, 191, 105); stroke-opacity: 0.4;"><title>22</title></path>
                        <path class="link" d="M5,35.88028169014085C163.75,35.88028169014085 163.75,25.880281690140873 322.5,25.880281690140873" style="stroke-width: 51.7606; fill: none; stroke: rgb(191, 105, 105); stroke-opacity: 0.4;"><title>21</title></path>
                        <path class="link" d="M5,244.43661971830983C163.75,244.43661971830983 163.75,264.29577464788736 322.5,264.29577464788736" style="stroke-width: 49.2958; fill: none; stroke: rgb(191, 156, 105); stroke-opacity: 0.4;"><title>20</title></path>
                        <path class="sak link" d="M327.5,274.1549295774648C486.25,274.1549295774648 486.25,246.83098591549293 645,246.83098591549293" style="stroke-width: 49.2958; fill: none; stroke: rgb(174, 105, 191); stroke-opacity: 0.4;"><title>20</title></path>
                        <path class="f link" d="M327.5,376.58450704225356C486.25,376.58450704225356 486.25,371.5845070422535 645,371.5845070422535" style="stroke-width: 46.831; fill: none; stroke: rgb(122, 105, 191); stroke-opacity: 0.4;"><title>19</title></path>
                        <path class="link" d="M5,312.35915492957747C163.75,312.35915492957747 163.75,312.35915492957747 322.5,312.35915492957747" style="stroke-width: 46.831; fill: none; stroke: rgb(174, 191, 105); stroke-opacity: 0.4;"><title>19</title></path>
                        <path class="sak link" d="M327.5,314.82394366197184C486.25,314.82394366197184 486.25,309.82394366197184 645,309.82394366197184" style="stroke-width: 32.0423; fill: none; stroke: rgb(174, 105, 191); stroke-opacity: 0.4;"><title>13</title></path>
                        <path class="link" d="M5,179.11971830985914C163.75,179.11971830985914 163.75,166.65492957746483 322.5,166.65492957746483" style="stroke-width: 32.0423; fill: none; stroke: rgb(191, 156, 105); stroke-opacity: 0.4;"><title>13</title></path>
                        <path class="lud link" d="M327.5,167.887323943662C486.25,167.887323943662 486.25,195.07042253521126 645,195.07042253521126" style="stroke-width: 29.5775; fill: none; stroke: rgb(105, 191, 191); stroke-opacity: 0.4;"><title>12</title></path>
                        <path class="link" d="M5,207.46478873239437C163.75,207.46478873239437 163.75,209.92957746478876 322.5,209.92957746478876" style="stroke-width: 24.6479; fill: none; stroke: rgb(191, 156, 105); stroke-opacity: 0.4;"><title>10</title></path>
                        <path class="lud link" d="M327.5,143.23943661971833C486.25,143.23943661971833 486.25,93.73239436619718 645,93.73239436619718" style="stroke-width: 19.7183; fill: none; stroke: rgb(105, 191, 191); stroke-opacity: 0.4;"><title>8</title></path>
                        <path class="husb link" d="M327.5,111.05633802816902C486.25,111.05633802816902 486.25,170.42253521126761 645,170.42253521126761" style="stroke-width: 19.7183; fill: none; stroke: rgb(105, 139, 191); stroke-opacity: 0.4;"><title>8</title></path>
                        <path class="link" d="M5,111.19718309859154C163.75,111.19718309859154 163.75,103.66197183098595 322.5,103.66197183098595" style="stroke-width: 14.7887; fill: none; stroke: rgb(122, 191, 105); stroke-opacity: 0.4;"><title>6</title></path>
                        <path class="link" d="M5,96.40845070422534C163.75,96.40845070422534 163.75,59.15492957746481 322.5,59.15492957746481" style="stroke-width: 14.7887; fill: none; stroke: rgb(122, 191, 105); stroke-opacity: 0.4;"><title>6</title></path>
                        <path class="ssbg link" d="M327.5,202.53521126760566C486.25,202.53521126760566 486.25,123.45070422535211 645,123.45070422535211" style="stroke-width: 14.7887; fill: none; stroke: rgb(191, 105, 156); stroke-opacity: 0.4;"><title>6</title></path>
                        <path class="ssbg link" d="M327.5,216.09154929577468C486.25,216.09154929577468 486.25,216.0211267605634 645,216.0211267605634" style="stroke-width: 12.3239; fill: none; stroke: rgb(191, 105, 156); stroke-opacity: 0.4;"><title>5</title></path>
                        <path class="link" d="M5,156.93661971830986C163.75,156.93661971830986 163.75,117.21830985915496 322.5,117.21830985915496" style="stroke-width: 12.3239; fill: none; stroke: rgb(191, 156, 105); stroke-opacity: 0.4;"><title>5</title></path>
                        <path class="link" d="M5,144.61267605633802C163.75,144.61267605633802 163.75,72.71126760563384 322.5,72.71126760563384" style="stroke-width: 12.3239; fill: none; stroke: rgb(191, 156, 105); stroke-opacity: 0.4;"><title>5</title></path>
                        <path class="isb link" d="M327.5,73.943661971831C486.25,73.943661971831 486.25,155.6338028169014 645,155.6338028169014" style="stroke-width: 9.85915; fill: none; stroke: rgb(105, 191, 139); stroke-opacity: 0.4;"><title>4</title></path>
                        <path class="link" d="M5,74.08450704225352C163.75,74.08450704225352 163.75,138.3098591549296 322.5,138.3098591549296" style="stroke-width: 9.85915; fill: none; stroke: rgb(191, 105, 105); stroke-opacity: 0.4;"><title>4</title></path>
                        <path class="sak link" d="M327.5,244.5774647887324C486.25,244.5774647887324 486.25,135.77464788732394 645,135.77464788732394" style="stroke-width: 9.85915; fill: none; stroke: rgb(174, 105, 191); stroke-opacity: 0.4;"><title>4</title></path>
                        <path class="husb link" d="M327.5,93.80281690140848C486.25,93.80281690140848 486.25,78.94366197183098 645,78.94366197183098" style="stroke-width: 9.85915; fill: none; stroke: rgb(105, 139, 191); stroke-opacity: 0.4;"><title>4</title></path>
                        <path class="link" d="M5,122.28873239436618C163.75,122.28873239436618 163.75,146.93661971830988 322.5,146.93661971830988" style="stroke-width: 7.39437; fill: none; stroke: rgb(122, 191, 105); stroke-opacity: 0.4;"><title>3</title></path>
                        <path class="ssbg link" d="M327.5,225.95070422535213C486.25,225.95070422535213 486.25,290.1056338028169 645,290.1056338028169" style="stroke-width: 7.39437; fill: none; stroke: rgb(191, 105, 156); stroke-opacity: 0.4;"><title>3</title></path>
                        <path class="link" d="M5,65.45774647887323C163.75,65.45774647887323 163.75,92.57042253521129 322.5,92.57042253521129" style="stroke-width: 7.39437; fill: none; stroke: rgb(191, 105, 105); stroke-opacity: 0.4;"><title>3</title></path>
                        <path class="link" d="M5,285.2464788732394C163.75,285.2464788732394 163.75,225.95070422535213 322.5,225.95070422535213" style="stroke-width: 7.39437; fill: none; stroke: rgb(174, 191, 105); stroke-opacity: 0.4;"><title>3</title></path>
                        <path class="sak link" d="M327.5,333.3098591549296C486.25,333.3098591549296 486.25,345.70422535211264 645,345.70422535211264" style="stroke-width: 4.92958; fill: none; stroke: rgb(174, 105, 191); stroke-opacity: 0.4;"><title>2</title></path>
                        <path class="f link" d="M327.5,350.7042253521127C486.25,350.7042253521127 486.25,328.30985915492954 645,328.30985915492954" style="stroke-width: 4.92958; fill: none; stroke: rgb(122, 105, 191); stroke-opacity: 0.4;"><title>2</title></path>
                        <path class="f link" d="M327.5,347.00704225352115C486.25,347.00704225352115 486.25,272.7112676056338 645,272.7112676056338" style="stroke-width: 2.46479; fill: none; stroke: rgb(122, 105, 191); stroke-opacity: 0.4;"><title>1</title></path>
                        <path class="link" d="M5,127.21830985915491C163.75,127.21830985915491 163.75,196.37323943661974 322.5,196.37323943661974" style="stroke-width: 2.46479; fill: none; stroke: rgb(122, 191, 105); stroke-opacity: 0.4;"><title>1</title></path>
                        <path class="husb link" d="M327.5,99.9647887323944C486.25,99.9647887323944 486.25,114.82394366197182 645,114.82394366197182" style="stroke-width: 2.46479; fill: none; stroke: rgb(105, 139, 191); stroke-opacity: 0.4;"><title>1</title></path>
                        <path class="link" d="M5,280.3169014084507C163.75,280.3169014084507 163.75,183.90845070422537 322.5,183.90845070422537" style="stroke-width: 2.46479; fill: none; stroke: rgb(174, 191, 105); stroke-opacity: 0.4;"><title>1</title></path>
                        <path class="lud link" d="M327.5,183.90845070422537C486.25,183.90845070422537 486.25,342.0070422535211 645,342.0070422535211" style="stroke-width: 2.46479; fill: none; stroke: rgb(105, 191, 191); stroke-opacity: 0.4;"><title>1</title></path>
                        <path class="husb link" d="M327.5,122.14788732394368C486.25,122.14788732394368 486.25,285.17605633802816 645,285.17605633802816" style="stroke-width: 2.46479; fill: none; stroke: rgb(105, 139, 191); stroke-opacity: 0.4;"><title>1</title></path>
                    </g>
                    <g>
                        <g class="node" transform="translate(322.5,345.77464788732397)"><rect height="54.22535211267605" width="5"><title>Facilitator 22</title></rect><text x="11" y="27.112676056338024" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Facilitators</text></g>
                        <g class="node" transform="translate(322.5,88.87323943661974)"><rect height="34.50704225352112" width="5"><title>High Usage Scoring Big 14</title></rect><text x="11" y="17.25352112676056" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">High Usage Scoring Bigs</text></g>
                        <g class="node" transform="translate(322.5,2.842170943040401e-14)"><rect height="78.87323943661971" width="5"><title>Inside Scoring Big 32</title></rect><text x="11" y="39.436619718309856" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Inside Scoring Bigs </text></g>
                        <g class="node" transform="translate(322.5,133.38028169014086)"><rect height="51.76056338028169" width="5"><title>Low Usage Defender 21</title></rect><text x="11" y="25.880281690140844" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Low Usage Defenders</text></g>
                        <g class="node" transform="translate(322.5,195.14084507042256)"><rect height="34.50704225352112" width="5"><title>Sweet-Shooting Bucket Getter 14</title></rect><text x="11" y="17.25352112676056" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Sweet-Shooting Bucket Getters</text></g>
                        <g class="node" transform="translate(322.5,239.64788732394368)"><rect height="96.12676056338027" width="5"><title>Swiss Army Knive 39</title></rect><text x="11" y="48.06338028169014" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Swiss Army Knives</text></g>
                        <g class="node" transform="translate(0,279.0845070422535)"><rect height="110.91549295774647" width="5"><title>Guard 45</title></rect><text x="11" y="55.45774647887323" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Guard</text></g>
                        <g class="node" transform="translate(0,10)"><rect height="69.01408450704224" width="5"><title>Non-Shooting Big 28</title></rect><text x="11" y="34.50704225352112" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Non-Shooting Big</text></g>
                        <g class="node" transform="translate(0,89.01408450704224)"><rect height="39.436619718309856" width="5"><title>Shooting Big 16</title></rect><text x="11" y="19.718309859154928" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Shooting Big</text></g>
                        <g class="node" transform="translate(0,138.4507042253521)"><rect height="130.6338028169014" width="5"><title>Wing 53</title></rect><text x="11" y="65.3169014084507" dy=".35em" text-anchor="start" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Wing</text></g>
                        <g class="node" transform="translate(645,340.7746478873239)"><rect height="54.22535211267605" width="5" style="fill: rgb(102, 102, 102);"><title>Facilitators 22</title></rect><text x="-6" y="27.112676056338024" dy=".35em" text-anchor="end" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Facilitators</text></g>
                        <g class="node" transform="translate(645,150.70422535211267)"><rect height="123.2394366197183" width="5" style="fill: rgb(102, 102, 102);"><title>Low Usage 3 + Ds 50</title></rect><text x="-6" y="61.61971830985915" dy=".35em" text-anchor="end" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Low Usage 3 + Ds</text></g>
                        <g class="node" transform="translate(645,5)"><rect height="98.59154929577464" width="5" style="fill: rgb(102, 102, 102);"><title>Non Shooting Rebounders 40</title></rect><text x="-6" y="49.29577464788732" dy=".35em" text-anchor="end" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Non Shooting Rebounders</text></g>
                        <g class="node" transform="translate(645,283.943661971831)"><rect height="46.83098591549295" width="5" style="fill: rgb(102, 102, 102);"><title>Scoring Guards 19</title></rect><text x="-6" y="23.415492957746476" dy=".35em" text-anchor="end" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Scoring Guards</text></g>
                        <g class="node" transform="translate(645,113.59154929577464)"><rect height="27.112676056338024" width="5" style="fill: rgb(102, 102, 102);"><title>Swiss Army Knives 11</title></rect><text x="-6" y="13.556338028169012" dy=".35em" text-anchor="end" style="font-size: 11px; font-family: Arial, Helvetica; pointer-events: none;">Swiss Army Knives</text></g>
                    </g>
                </g>
            </svg>
            </div>
        </div>
        </div>


        <div class="row padding-top-bottom border-bottom-always" style="text-align: center;padding-bottom:50px;" >
        {% if player.gamelog[0] != None %}
                <h3>2017-18 Game Log</h3>
                <div>
                    <table id="gamelog_table" class="display compact" style="width:100%;white-space:nowrap;">
                        <thead>
                        <tr>
                            <th>Game</th>
                            <th>W/L</th>
                            <th>MIN</th>
                            <th>FGM</th>
                            <th>FGA</th>
                            <th>FG%</th>
                            <th>3PM</th>
                            <th>3PA</th>
                            <th>3P%</th>
                            <th>FTM</th>
                            <th>FTA</th>
                            <th>PTS</th>
                            <th>REB</th>
                            <th>AST</th>
                            <th>STL</th>
                            <th>BLK</th>
                            <th>TOV</th>
                            <th>+/-</th>
                            <th>Shot<br>Chart</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for game in player.gamelog[0] %}
                            <tr>
                                <td style="border-right:1px lightgrey solid">{{ game[3] }}<br>{{ game[4] }}</td>
                                <td>{{ game[5] }}</td>
                                <td>{{ game[6] }}</td>
                                <td>{{ game[7] }}</td>
                                <td>{{ game[8] }}</td>
                                <td>{{ game[9] }}</td>
                                <td>{{ game[10] }}</td>
                                <td>{{ game[11] }}</td>
                                <td>{{ game[12] }}</td>
                                <td>{{ game[13] }}</td>
                                <td>{{ game[14] }}</td>
                                <td>{{ game[24] }}</td>
                                <td>{{ game[18] }}</td>
                                <td>{{ game[19] }}</td>
                                <td>{{ game[20] }}</td>
                                <td>{{ game[21] }}</td>
                                <td>{{ game[22] }}</td>
                                <td>{{ game[25] }}</td>
                                <td style="border-left:1px lightgrey solid"><input name="games" value="{{ game[2] }}" id="{{ game[4] }}" type="radio" onclick="changeShotChart()" /></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}

            <div class="row border-bottom-always" style="padding-bottom:40px;padding-top:20px;">
                <div class="col-xs-12 col-sm-6 col-md-7" style="text-align:center;">
                    <div class="row" style="padding-bottom:10px;">
                        <h3>2017-18 Shot Profile</h3>
                    </div>
                     <div class="row" style="padding:15px;">
                        <h4>The size of the slice represents the percentage of shots taken from that location (shot frequency).</h4>
                        <h4>The color of the slice represents FG% in that location relative to all G League players of the same position (shot accuracy).</h4>
                    </div>
                    <canvas id="shooting"></canvas>

                    <h5 style="font-size:12px;margin:0 auto;padding:20px;">Percentiles are calculatde relative to all qualified G League Players (over 200 min) <strong>of the same position.</strong> Hover over the shot location to see {{ player.name }}'s FG% at that location as well as the percentage of total FGA that came from there.</h5>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-5" style="text-align:center">
                    <h3 id="shotchart-title">2017-18 Shot Chart</h3>
                <div id="iframe-container" style="height:385px;">
                    <iframe height="100%" src="http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=0&DateFrom=&DateTo=&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1"></iframe>
                </div>
                <input class="button-style" style="margin-top:30px !important ;width:230px;margin:0;text-align:center" id="changeShotChart" type="button" onclick="getFullSeasonSC()" value="View Full Season Shot Chart">
                <p style="padding: 10px 0;text-align:center;max-width:350px;margin:0 auto;">
                    <span style='display:inline;text-align: right;'>Shot Chart Game Range:</span>
                    <span id="amount" style="display:inline;border:0; color:rgb(0,0,0); font-weight:bold;text-align:right"></span>
                </p>
                <div style='text-align:center;margin:0 auto;max-width:280px;' id="slider"></div>
                </div>
            </div>

    <div class="row center padding-20">
        {% if player.nba_comps != None %}
        <div class="row padding-top-bottom">
            <h3>NBA player comparisons using the <a href="https://gleague.nba.com/news/introducing-nba-projections/">G League's NBA Projections tool:</a></h3>
            <h4>These NBA comparisons are based on <strong> pace-adjusted per 36 minute boxscore stats </strong> and each player is required to have played at least 300 min.</h4>
        </div>
        <div class="row">
            <h3 style="color:green">Use the checkboxes below to narrow your NBA comparison search:</h3>
            <button class='button-style' onclick="check_uncheck_all(this)" id='checkall' data-checked='false'>Check/Uncheck All</button>
            <div class="wrapper">
                <input class="pad" type="checkbox" id="pts" value="pts" checked/><label for="pts" class="pad">PTS</label>
            </div>
            <div class="wrapper">  
                <input class="pad" type="checkbox" id="reb" value="reb" checked/><label for="reb" class="pad">REB</label>
            </div>            
            <div class="wrapper">
                <input class="pad" type="checkbox" id="ast" value="ast" checked/><label for="ast" class="pad">AST</label>
            </div>
            <div class="wrapper">
                <input class="pad" type="checkbox" id="stl" value="stl" checked/><label for="stl" class="pad">STL</label>
            </div>           
            <div class="wrapper"><input class="pad" type="checkbox" id="blk" value="blk" checked/><label for="blk" class="pad">BLK</label></div>
            <div class="wrapper"><input class="pad" type="checkbox" id="fgper" value="fgper" checked/><label for="fgper" class="pad">FG%</label></div>
            <div class="wrapper"><input class="pad" type="checkbox" id="threeper" value="threeper" checked/><label for="threeper" class="pad">3P%</label></div>
            <div class="wrapper"><input class="pad" type="checkbox" id="ftper" value="ftper" checked/><label for="ftper" class="pad">FT%</label></div>

            {% if player.height != "" %}
            <div class="wrapper"><input class="pad" type="checkbox" id="height" value="height" checked/><label for="height" class="pad">Height</label></div>
            <div class="wrapper"><input class="pad" type="checkbox" id="weight" value="weight" checked/><label for="weight" class="pad">Weight</label></div>
            {% endif %}
            <input class="button-style" id="getCompsButton" type="submit" value="Find NBA Comparisons">
        </div>

        <div class="row padding-20">
            <div id="loader" style="display:none;padding-top:150px;" class="row center">
                <div style="position:relative;" class="loader"></div>
            </div>
            <div class="row" id="comp-content">
                <div class="col-xs-12 col-sm-4 padding-bottom">
                    <div  class="row center">
                        <img id="img1" class="nba-comp-headshot center comparisons"
                             src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/latest/260x190/{{ neighbors_json[0].id }}.png" onerror="usePlaceholder(this)">
                        <h4 style="margin-bottom:0;" id="name1" class="center">{{ neighbors_json[0].name }}<img id="logo1" class="logo" src="https://stats.nba.com/media/img/teams/logos/{{ neighbors_json[0].team }}_logo.svg"> </h4>
                        <div class="row center">
                            <span style="font-size:12px;" id="hwpos1" class="center">{{ neighbors_json[0].height }} • {{ neighbors_json[0].weight }} lbs • {{ neighbors_json[0].position }}</span>
                        </div>
                        <div class='comp1_stats' style="position: relative;max-width:90%;margin:0 auto;">
                            <p id='g_mpg1' style="padding-top:5px;font-size:11px;margin:0;">{{neighbors_json[0].nba_g }} Games Played • {{ neighbors_json[0].mpg }} min/G</p>
                            <canvas id="comp1_stats"></canvas>
                            <p style="text-align: center;padding-left:40px;padding-bottom:5px;margin:0;font-size:9px;font-style:italic;">50th percentile</p>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4 padding-bottom">
                    <div  class="row center">
                        <img id="img2" class="nba-comp-headshot center comparisons"
                             src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/latest/260x190/{{ neighbors_json[1].id }}.png" onerror="usePlaceholder(this)">
                        <h4 style="margin-bottom:0;" id="name2" class="center">{{ neighbors_json[1].name }}<img id="logo2" class="logo" src="https://stats.nba.com/media/img/teams/logos/{{ neighbors_json[1].team }}_logo.svg"> </h4>
                        <div class="row center">
                            <span style="font-size:12px;" id="hwpos2" class="center">{{ neighbors_json[1].height }} • {{ neighbors_json[1].weight }} lbs • {{ neighbors_json[1].position }}</span>
                        </div>
                        <div class='comp2_stats' style="position: relative;max-width:90%;margin:0 auto;">
                            <p id='g_mpg2' style="padding-top:5px;font-size:11px;margin:0;">{{neighbors_json[1].nba_g }} Games Played • {{ neighbors_json[1].mpg }} min/G</p>
                            <canvas id="comp2_stats"></canvas>
                            <p style="text-align: center;padding-left:40px;padding-bottom:5px;margin:0;font-size:9px;font-style:italic;">50th percentile</p>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4 padding-bottom">
                    <div  class="row center">
                        <img id="img3" class="nba-comp-headshot center comparisons"
                             src="https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/latest/260x190/{{ neighbors_json[2].id }}.png" onerror="usePlaceholder(this)">
                        <h4 style="margin-bottom:0;" id="name3" class="center">{{ neighbors_json[2].name }}<img id="logo3" class="logo" src="https://stats.nba.com/media/img/teams/logos/{{ neighbors_json[2].team }}_logo.svg"> </h4>
                        <div class="row center">
                            <span style="font-size:12px;" id="hwpos3" class="center">{{ neighbors_json[2].height }} • {{ neighbors_json[2].weight }} lbs • {{ neighbors_json[2].position }}</span>
                        </div>
                        <div class='comp3_stats' style="position: relative;max-width:90%;margin:0 auto;">
                            <p id='g_mpg3' style="padding-top:5px;font-size:11px;margin:0;">{{neighbors_json[2].nba_g }} Games Played • {{ neighbors_json[2].mpg }} min/G</p>
                            <canvas id="comp3_stats"></canvas>
                            <p style="text-align: center;padding-left:40px;padding-bottom:5px;margin:0;font-size:9px;font-style:italic;">50th percentile</p>
                        </div>
                    </div>
                </div>
                <h5 style="font-size:10px;margin:8px;">Percentiles relative to all qualified NBA Players (over 300 min) <strong>of the same position.</strong> Hover over the bar to see the percentile.</h5>

{#                <div class="row padding-20">#}
{##}
{#                    <table class="table table-striped table-bordered table-hover table-responsive stats">#}
{#                        <thead>#}
{#                        <tr>#}
{#                            <th></th>#}
{#                            <th>G League</th>#}
{#                            <th>NBA</th>#}
{#                        </tr>#}
{#                        </thead>#}
{#                        <tbody>#}
{#                        <tr>#}
{#                            <td>#}
{#                                GP#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_g }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_g }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                PTS#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_pts }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_pts}}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                FGA#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_fga }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_fga }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                3PM#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_threepm }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_threepm }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                REB#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_reb }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_reb }}#}
{#                            </td>#}
{#                        </tr>#}
{#                        <tr>#}
{#                            <td>#}
{#                                AST#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.gl_ast }}#}
{#                            </td>#}
{#                            <td>#}
{#                                {{ n.nba_ast }}#}
{#                            </td>#}
{#                        </tr>#}
{##}
{##}
{#                        </tbody>#}
{#                    </table>#}
{#                </div>#}
            </div>
    </div>
    {% endif %}
</div>
</div>

    <script>

        function ordinal_suffix_of(i) {
            var j = i % 10,
                k = i % 100;
            if (j === 1 && k !== 11) {
                return i + "st";
            }
            if (j === 2 && k !== 12) {
                return i + "nd";
            }
            if (j === 3 && k !== 13) {
                return i + "rd";
            }
            return i + "th";
        }
        //Create horizontalBar plug-in for ChartJS
        var originalLineDraw = Chart.controllers.horizontalBar.prototype.draw;
        Chart.helpers.extend(Chart.controllers.horizontalBar.prototype, {

          draw: function () {
              originalLineDraw.apply(this, arguments);

              var chart = this.chart;
              var ctx = chart.chart.ctx;

              var index = chart.config.options.lineAtIndex;
              if (index) {

                  var xaxis = chart.scales['x-axis-0'];
                  var yaxis = chart.scales['y-axis-0'];

                  var x1 = xaxis.getPixelForValue(index);
                  var y1 = 10;

                  var x2 = xaxis.getPixelForValue(index);
                  var y2 = yaxis.height + 15;

                  ctx.save();
                  ctx.beginPath();
                  ctx.moveTo(x1, y1);
                  ctx.strokeStyle = 'black';
                  ctx.lineTo(x2, y2);
                  ctx.stroke();

                  ctx.restore();
              }
          }
        });

        // main stats bar chart
        $(document).ready( function () {
            var ctx = document.getElementById("player_stats");
            var player_stats = new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: {{ player.stats[0] | safe }},
                    datasets: [{
                        data: {{ player.percentile_array[0][1] }},
                        percentiles: {{ player.percentile_array[0][0] }},
                        backgroundColor: {{ player.percentile_array[0][2] | safe }},
                        stats: {{ player.stats[1] | safe }},
                        borderWidth:0,
                    }]

                },
                options: {
                    lineAtIndex: 0.01,
                    layout: {
                        padding: {
                            left: 5,
                            right: 5,
                            top: 10,
                            bottom: 0
                        }
                    },
                    plugins: {
                        datalabels: {
                            formatter: function (value, context) {
                                return context.chart.data.datasets[0].stats[context.dataIndex];

                            },
                            anchor: 'end',
                            align: 'end',
                            offset: 5,
                            color: 'black',
                            font:{
                                size: '10'
                            }
                        }
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true,
                                reverse: true
                            },
                            gridLines: {
                                display:true
                            },
                            categoryPercentage: 1,
                            barPercentage: 0.9
                        }],
                        xAxes: [{
                            gridLines: {
                                display:false
                            },
                            ticks: {
                                display: false,
                                min: -60,
                                max: 60,
                                stepSize: 10
                            }
                        }]
                    },
                    tooltips: {
                        callbacks: {
                            label: function(tooltipItem, data ) {
                                var x = tooltipItem.index;
                                var stats = data.datasets[0].stats;
                                var percentiles = data.datasets[0].percentiles;
                                var string = stats[x].toString() + " per 36 (";
                                var suffix = ordinal_suffix_of(Math.round(percentiles[x]));
                                var s = string + suffix.toString() + " " + "percentile)";
                                return(s);
                            }
                        }
                    },
                    legend: {
                        display: false
                    }
                }
            });
        });

        //advanced stats
        $(document).ready( function () {
            var ctx_2 = document.getElementById("player_adv_stats");
            var adv_stats = new Chart(ctx_2, {
                type: 'horizontalBar',
                data: {
                    labels: {{ player.advanced_stats[0] | safe }},
                    datasets: [{
                        data: {{ player.percentile_array[1][1] | safe }},
                        percentiles: {{ player.percentile_array[1][0] | safe }},
                        backgroundColor: {{ player.percentile_array[1][2] | safe }},
                        stats: {{ player.advanced_stats[2] | safe }},
                        borderWidth:0
                    }]

                },
                options: {
                    lineAtIndex: 0.01,
                    layout: {
                        padding: {
                            left: 5,
                            right: 5,
                            top: 10,
                            bottom: 0
                        }
                    },
                    plugins: {
                        datalabels: {
                            formatter: function (value, context) {
                                return parseFloat(context.chart.data.datasets[0].stats[context.dataIndex]).toFixed(1).toString();

                            },
                            anchor: 'end',
                            align: 'end',
                            offset: 5,
                            color: 'black',
                            font:{
                                size: '10'
                            }
                        }
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true,
                                reverse: true
                            },
                            gridLines: {
                                display:true
                            },
                            categoryPercentage: 1,
                            barPercentage: 0.9
                        }],
                        xAxes: [{
                            gridLines: {
                                display:false
                            },
                            ticks: {
                                display: false,
                                min: -60,
                                max: 60,
                                stepSize: 10
                            }
                        }]
                    },
                    tooltips: {
                        callbacks: {
                            label: function(tooltipItem, data ) {
                                var x = tooltipItem.index;
                                var stats = data.datasets[0].stats;
                                var percentiles = data.datasets[0].percentiles;
                                var string = parseFloat(stats[x]).toFixed(1).toString() + " (";
                                var suffix = ordinal_suffix_of(Math.round(percentiles[x]));
                                var s = string + suffix.toString() + " " + "percentile)";
                                return(s);
                            }
                        }
                    },
                    legend: {
                        display: false
                    }
                }
            });
        });

        function create_bar_chart(chart_id, neighbors_json){
            var ctx = document.getElementById(chart_id);
            var chart = new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: neighbors_json.stats[0],
                    datasets: [{
                        data: neighbors_json.percentile_array[1],
                        percentiles: neighbors_json.percentile_array[0],
                        backgroundColor: neighbors_json.percentile_color_array,
                        stats: neighbors_json.stats[1],
                        borderColor: '#000000',
                        borderWidth:0
                    }]

                },
                options: {
                    lineAtIndex: 0.01,
                    layout: {
                        padding: {
                            left: 10,
                            right: 10,
                            top: 10,
                            bottom: 0
                        }
                    },
                    plugins: {
                        datalabels: {
                            formatter: function (value, context) {
                                return context.chart.data.datasets[0].stats[context.dataIndex];

                            },
                            anchor: 'end',
                            align: 'end',
                            offset: 5,
                            color: 'black',
                            font:{
                                size: '10'
                            }

                        },
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true,
                                reverse: true
                            },
                            gridLines: {
                                display:true
                            },
                            categoryPercentage: 1,
                            barPercentage: 0.9
                        }],
                        xAxes: [{
                            gridLines: {
                                display:false
                            },
                            ticks: {
                                display: false,
                                min: -60,
                                max: 60,
                                stepSize: 10
                            }
                        }]
                    },
                    tooltips: {
                        callbacks: {
                            label: function(tooltipItem, data ) {
                                var x = tooltipItem.index;
                                var stats = data.datasets[0].stats;
                                var percentiles = data.datasets[0].percentiles;
                                var string = stats[x].toString() + " per 36 (";
                                var suffix = ordinal_suffix_of(Math.round(percentiles[x]));
                                var s = string + suffix.toString() + " " + "percentile)";
                                return(s);
                            }
                        }
                    },
                    legend: {
                        display: false
                    }
                }
            });
        }

        // create shooting radar chart
        $(document).ready( function () {
            var ctx_2 = document.getElementById("shooting");
            var shooting = new Chart(ctx_2, {
                type: 'doughnut',
                data: {
                    labels: {{ player.shooting_stats[0] | safe }},
                    datasets: [{
                        data: {{ player.shooting_stats[1] | safe }},
                        fgper: {{ player.shooting_stats[2] | safe }},
                        percentiles: {{ player.percentile_array[2][0] | safe }},
                        backgroundColor: {{ player.percentile_array[2][2] | safe }},
                        stats: {{ player.shooting_stats[3] | safe }},
                        borderWidth:1,
                        borderColor:'black'
                    }]

                },
                options: {
                    layout: {
                        padding: {
                            left: 5,
                            right: 5,
                            top: 15,
                            bottom: 15
                        }
                    },
                    plugins: {
                        datalabels: {
                            formatter: function (value, context) {
                                if(context.chart.data.datasets[0].data[context.dataIndex] !== 0.0)
                                    return context.chart.data.labels[context.dataIndex];
                                else
                                    return "";

                            },
                            anchor: 'start',
                            align: 'end',
                            offset: 10,
                            rotation: 20,
                            color: 'black',
                            font:{
                                size: '10'
                            }
                        }
                    },
                    tooltips: {
                        callbacks: {
                            label: function(tooltipItem, data){
                                return data.labels[tooltipItem.index]
                            },
                            afterLabel: function(tooltipItem, data ) {
                                x = tooltipItem.index;
                                stat_type = data.labels;
                                freq = data.datasets[0].data;
                                freq_per = Math.round(freq[x]* 100);
                                freq_line = freq_per.toString() + "% of all FGA";
                                stats = data.datasets[0].stats;
                                fgper = data.datasets[0].fgper;
                                fgper_str = Math.round(fgper[x] * 100).toString() + "%";
                                percentiles = data.datasets[0].percentiles;
                                suffix = ordinal_suffix_of(Math.round(percentiles[x]));
                                s = stats[x] + " = " + fgper_str + " FG% (" + suffix.toString() + " " + "percentile)";
                                return([s, freq_line]);
                            }
                        }
                    },
                    legend: {
                        display: false
                    }
                }
            });
        });

        var cluster = '{{ player.gnb_cluster }}';
        var paths = $("svg g path");
        for(i = 0; i < paths.length; i++) {
            var class_name = paths[i].className.baseVal;
            paths[i].style.strokeOpacity = "0.25";
            if (class_name === "f link" && cluster === "Facilitator") {
                paths[i].style.strokeOpacity = "1";
            }
            else if (class_name === "isb link" && cluster === "Inside Scoring Big") {
                paths[i].style.strokeOpacity = "1";
            }
            else if (class_name === "husb link" && cluster === "High Usage Scoring Big") {
                paths[i].style.strokeOpacity = "1";
            }
            else if (class_name === "sak link" && cluster === "Swiss Army Knife") {
                paths[i].style.strokeOpacity = "1";
            }
            else if (class_name === "ssbg link" && cluster === "Sweet-Shooting Bucket Getter") {
                paths[i].style.strokeOpacity = "1";
            }
            else if (class_name === "lud link" && cluster === "Low Usage Defender") {
                paths[i].style.strokeOpacity = "1";
            }
        }

        function getFullSeasonSC(){
            $("input[type='radio'][name='games']:checked").prop("checked", false);
            document.getElementById('slider').noUiSlider.reset();
             $( "#amount" ).text( "Game 1" + " - Game " + {{ player.gp }} );
            $("#iframe-container").empty();
            $("#shotchart-title").html("2017-18 Shot Chart");
            var url = "http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=0&DateFrom=&DateTo=&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1";
            $("#iframe-container").append("<iframe height=\"100%\" src='" + url + "' />");
        }

        var slider = document.getElementById('slider');
        var num_games = {{ player.gp }};
        var game_dates = {{ player.gamelog[1] | safe }};
        noUiSlider.create(slider, {
            start: [1, num_games],
            connect: true,
            behaviour: 'drag',
            range: {
                'min': 1,
                'max': num_games
            },
            step: 1
        });

        $( "#amount" ).text( "Game 1" + " - Game " + Math.round(num_games) );

        slider.noUiSlider.on('slide', function(){
            start = slider.noUiSlider.get()[0];
            end = slider.noUiSlider.get()[1];
            $( "#amount" ).text( "Game " + Math.round(start) + " - Game " + Math.round(end) );
            start_date =  game_dates[start - 1];
            end_date = game_dates[end  - 1];
            $("input[type='radio'][name='games']:checked").prop("checked", false);
            $("#iframe-container").empty();
            $("#shotchart-title").html(start_date.replace("-2018", "").replace("-2017", "") + " - " + end_date.replace("-2018", "").replace("-2017", "") +  " Shot Chart");
            var url = "http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=0&DateFrom=" + start_date + "&DateTo=" + end_date + "&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1";
            $("#iframe-container").append("<iframe height=\"100%\" src='" + url + "' />");
        });


        function changeShotChart(){
            var count = 0;
            var start_date, end_date;
            var gameID = $("input[type='radio'][name='games']:checked").val();
            var game = $("input[type='radio'][name='games']:checked").attr('id');
            if(gameID === null){
                $("#iframe-container").empty();
                document.getElementById('slider').noUiSlider.reset();
                $("#shotchart-title").html("2017-18 Shot Chart");
                var url = "http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=0&DateFrom=&DateTo=&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1";
                $("#iframe-container").append("<iframe height=\"100%\" src='" + url + "' />");
            }
            else{
                $("#iframe-container").empty();
                $("#shotchart-title").html(game +" Shot Chart");
                var url = "http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=" + gameID + "&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=0&DateFrom=&DateTo=&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1";
                $("#iframe-container").append("<iframe height=\"100%\" src='" + url + "' />");
            }
{#            $("input:checkbox[class=games]:checked").each(function () {#}
{#                count += 1;#}
{#                if(count === 1){#}
{#                    date = $(this).val().split("-");#}
{#                    gameID = $(this).attr('id');#}
{#                    end_date = date[1] + "/" + date[2] + "/" + date[0]#}
{#                }#}
{#                if(count > 1){#}
{#                    date = $(this).val().split("-");#}
{#                    start_date = date[1] + "/" + date[2] + "/" + date[0]#}
{#                }#}
{#            });#}
{#            if(count === 0){#}
{#                $("#iframe-container").empty();#}
{#                $("#shotchart-title").html("2017-18 Shot Chart");#}
{#                var url = "http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=0&DateFrom=&DateTo=&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1";#}
{#                $("#iframe-container").append("<iframe height=\"100%\" src='" + url + "' />");#}
{#                //btn.value = "View Shot Chart for Last 10 Games Only";#}
{#            }#}
{#            else if(count === 1){#}
{#                $("#iframe-container").empty();#}
{#                $("#shotchart-title").html(start_date +" Shot Chart");#}
{#                var url = "http://stats.gleague.nba.com/shotchart/#!/?CFID=33&CFPARAMS=2017-18&PlayerID={{ player.id }}&TeamID=0&GameID=" + gameID + "&ContextMeasure=FGA&Season=2017-18&SeasonType=Regular%20Season&MeasureType=Base&LeagueID=20&PerMode=PerGame&PlusMinus=N&PaceAdjust=N&Rank=N&Outcome=&Location=&Month=0&SeasonSegment=&OpponentTeamID=0&VsConference=&VsDivision=&GameSegment=&Period=0&LastNGames=10&DateFrom=&DateTo=&PORound=0&ShotClockRange=&mtype=&mtitle=&mode=Advanced&showZones=0&showDetails=0&showShots=1";#}
{#                $("#iframe-container").append("<iframe height=\"100%\" src='" + url + "' />");#}
{#                //btn.value = "View Full Season Shot Chart";#}
{#            }#}
{#            else{#}
{#                console.log(start_date + " --- " + end_date);#}
{#            }#}

        }

        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        }

        data = {{ neighbors_json | safe }};
        if(data != null) {
            create_bar_chart("comp1_stats", data[0]);
            create_bar_chart("comp2_stats", data[1]);
            create_bar_chart("comp3_stats", data[2]);
        }


    </script>
{% endblock %}